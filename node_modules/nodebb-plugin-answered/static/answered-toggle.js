$(document).ready(function() {
  $(document).on('click', '#answeredToggleBtn', function() {
    const $btn = $(this);
    // If button text says "Mark as Answered", then we are marking answered => true
    // If it says "Mark as Unanswered", then we are marking answered => false
    const markAnswered = $btn.text().toLowerCase().includes('answered');
    const tid = ajaxify.data.tid;

    $btn.prop('disabled', true);

    $.ajax({
      url: `${config.relative_path}/api/topic/${tid}/answer-status`,
      type: 'PUT',
      data: { answered: markAnswered },
      success: function(response) {
        // If the user clicked Mark as Answered => show 'Mark as Unanswered' next
        if (markAnswered) {
          $btn.text('Mark as Unanswered');
        } else {
          $btn.text('Mark as Answered');
        }
      },
      error: function(err) {
        console.error('Error updating answered status:', err);
        alert('Could not update. Please try again.');
      },
      complete: function() {
        $btn.prop('disabled', false);
      }
    });
  });
});
